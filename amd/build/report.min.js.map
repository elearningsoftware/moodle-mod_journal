{"version":3,"file":"report.min.js","sources":["../src/report.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Javascript module for the report page\n *\n * @module      mod_journal/createtemplate\n * @copyright   2022 elearning & software srl\n * @license     http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport Notification from 'core/notification';\nimport {get_string as getString} from 'core/str';\nimport {add as addToast} from 'core/toast';\nimport $ from 'jquery';\n\nexport const init = () => {\n    $('.saveindividualfeedback').on('click', event => {\n        event.preventDefault();\n        const editorupdated = new CustomEvent('form:editorUpdated');\n        event.target.dispatchEvent(editorupdated);\n        const element = $(event.currentTarget);\n        const sesskey = M.cfg.sesskey;\n        const cmid = element.attr('data-cmid');\n        const userid = element.attr('data-userid');\n        const entryid = element.attr('data-entryid');\n        const feedback = $('[name=\"c' + entryid + '[text]\"]').val();\n        const grade = $('#r' + entryid).val();\n        const itemid = element.attr('data-itemid');\n\n        $.ajax(M.cfg.wwwroot + '/mod/journal/ajax/ajax.php', {\n            data: {\n                action: 'saveindividualfeedback',\n                sesskey,\n                cmid,\n                userid,\n                entryid,\n                feedback,\n                grade,\n                itemid\n            },\n            dataType: 'json',\n            method: 'post',\n            success: (response) => {\n                if (response.status === 'ok') {\n                    addToast(response.content);\n                } else {\n                    getString('saving_failed', 'feedback').then(string => {\n                        return Notification.addNotification({\n                            type: 'error',\n                            message: string + ': ' + response.content\n                        });\n                    }).catch();\n                }\n            },\n            error: (error) => {\n                getString('saving_failed', 'feedback').then(string => {\n                    return Notification.addNotification({\n                        type: 'error',\n                        message: string + ': ' + error\n                    });\n                }).catch();\n            }\n        });\n    });\n};"],"names":["on","event","preventDefault","editorupdated","CustomEvent","target","dispatchEvent","element","currentTarget","sesskey","M","cfg","cmid","attr","userid","entryid","feedback","val","grade","itemid","ajax","wwwroot","data","action","dataType","method","success","response","status","content","then","string","Notification","addNotification","type","message","catch","error"],"mappings":";;;;;;;4LA4BoB,yBACd,2BAA2BA,GAAG,SAASC,QACrCA,MAAMC,uBACAC,cAAgB,IAAIC,YAAY,sBACtCH,MAAMI,OAAOC,cAAcH,qBACrBI,SAAU,mBAAEN,MAAMO,eAClBC,QAAUC,EAAEC,IAAIF,QAChBG,KAAOL,QAAQM,KAAK,aACpBC,OAASP,QAAQM,KAAK,eACtBE,QAAUR,QAAQM,KAAK,gBACvBG,UAAW,mBAAE,WAAaD,QAAU,YAAYE,MAChDC,OAAQ,mBAAE,KAAOH,SAASE,MAC1BE,OAASZ,QAAQM,KAAK,+BAE1BO,KAAKV,EAAEC,IAAIU,QAAU,6BAA8B,CACjDC,KAAM,CACFC,OAAQ,yBACRd,QAAAA,QACAG,KAAAA,KACAE,OAAAA,OACAC,QAAAA,QACAC,SAAAA,SACAE,MAAAA,MACAC,OAAAA,QAEJK,SAAU,OACVC,OAAQ,OACRC,QAAUC,WACkB,OAApBA,SAASC,sBACAD,SAASE,6BAER,gBAAiB,YAAYC,MAAKC,QACjCC,sBAAaC,gBAAgB,CAChCC,KAAM,QACNC,QAASJ,OAAS,KAAOJ,SAASE,YAEvCO,SAGXC,MAAQA,4BACM,gBAAiB,YAAYP,MAAKC,QACjCC,sBAAaC,gBAAgB,CAChCC,KAAM,QACNC,QAASJ,OAAS,KAAOM,UAE9BD"}